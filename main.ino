#include <IRremote.h>

#define BAUD 9600
#define RECV_PIN 11
#define RECV_DELAY 750

IRsend irsend;
IRrecv irrecv(RECV_PIN);
decode_results results;

// Command #1: CURSOR ENTER
// Protocol: necx1, Parameters: S=45U D=45U F=88U
const uint16_t CURSOR_ENTER[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 44268 };

// Command #2: CURSOR DOWN
// Protocol: necx1, Parameters: S=45U D=45U F=72U
const uint16_t CURSOR_DOWN[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 44268 };

// Command #3: HOME
// Protocol: necx1, Parameters: S=45U D=45U F=103U
const uint16_t HOME[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 44268 };

// Command #4: CURSOR RIGHT
// Protocol: necx1, Parameters: S=45U D=45U F=90U
const uint16_t CURSOR_RIGHT[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 44268 };

// Command #5: CURSOR UP
// Protocol: necx1, Parameters: S=45U D=45U F=71U
const uint16_t CURSOR_UP[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 44268 };

// Command #6: DISC MENU
// Protocol: necx1, Parameters: S=45U D=45U F=75U
const uint16_t DISC_MENU[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 44268 };

// Command #7: POWER
// Protocol: necx1, Parameters: S=45U D=45U F=48U
const uint16_t POWER[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 44268 };

// Command #8: CURSOR LEFT
// Protocol: necx1, Parameters: S=45U D=45U F=89U
const uint16_t CURSOR_LEFT[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 44268 };

// Command #9: PAUSE
// Protocol: necx1, Parameters: S=45U D=45U F=56U
const uint16_t PAUSE[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 44268 };

// Command #10: OPEN/CLOSE
// Protocol: necx1, Parameters: S=45U D=45U F=54U
const uint16_t OPEN_CLOSE[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 44268 };

// Command #11: PLAY
// Protocol: necx1, Parameters: S=45U D=45U F=49U
const uint16_t PLAY[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 44268 };

// Command #12: STOP
// Protocol: necx1, Parameters: S=45U D=45U F=57U
const uint16_t STOP[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 44268 };

// Command #2: SCAN<<
// Protocol: necx1, Parameters: S=45U D=45U F=50U
const uint16_t SCAN_BW[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 44268 };

// Command #3: SCAN>>
// Protocol: necx1, Parameters: S=45U D=45U F=51U
const uint16_t SCAN_FW[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 44268 };

// Command #4: TRACK +
// Protocol: necx1, Parameters: S=45U D=45U F=52U
const uint16_t TRACK_NEXT[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 44268 };

// Command #5: TRACK -
// Protocol: necx1, Parameters: S=45U D=45U F=53U
const uint16_t TRACK_PREV[] PROGMEM = { 4512U, 4512U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 1692U, 564U, 564U, 564U, 564U, 564U, 1692U, 564U, 1692U, 564U, 44268 };

static void sendRaw(const uint16_t data_P[], size_t length, uint16_t frequency) {
    uint16_t data[length];
    memcpy_PF(data, (uint_farptr_t) data_P, sizeof(uint16_t) * length);
    irsend.sendRaw(data, length, frequency);
}

void setup() {
    Serial.begin(BAUD);
    Serial.println(F("IRduino is starting up!"));
    irrecv.enableIRIn();
}

void loop() {
    if (irrecv.decode(&results)) {
        Serial.print(F("Received signal with hex data: "));
        Serial.println(results.value, HEX);
        switch (results.value) {
            case 0x1000E0FL:
                sendRaw(POWER, 68U, 38U);
                break;
            case 0x1004E4FL:
                sendRaw(OPEN_CLOSE, 68U, 38U);
                break;
            case 0x1008E8FL:
                sendRaw(HOME, 68U, 38U);
                break;
            case 0x100CECFL:
                sendRaw(DISC_MENU, 68U, 38U);
                break;
            case 0x1009293L:
                sendRaw(CURSOR_ENTER, 68U, 38U);
                break;
            case 0x1005253L:
                sendRaw(CURSOR_UP, 68U, 38U);
                break;
            case 0x100D2D3L:
                sendRaw(CURSOR_DOWN, 68U, 38U);
                break;
            case 0x1007273L:
                sendRaw(CURSOR_LEFT, 68U, 38U);
                break;
            case 0x100F2F3L:
                sendRaw(CURSOR_RIGHT, 68U, 38U);
                break;
            case 0x1900392L:
                sendRaw(PLAY, 68U, 38U);
                break;
            case 0x1908312L:
                sendRaw(PAUSE, 68U, 38U);
                break;
            case 0x19043D2L:
                sendRaw(STOP, 68U, 38U);
                break;
            case 0x19023B2L:
                sendRaw(SCAN_BW, 68U, 38U);
                break;
            case 0x190C352L:
                sendRaw(SCAN_FW, 68U, 38U);
                break;
            case 0x190BB2AL:
                sendRaw(TRACK_NEXT, 68U, 38U);
                break;
            case 0x1903BAAL:
                sendRaw(TRACK_PREV, 68U, 38U);
                break;
        }
        irrecv.enableIRIn();
    }
    delay(RECV_DELAY);
}
